/**
 * This file is part of Moodle - http://moodle.org/
 *
 * Moodle is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Moodle is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
 *
 * @package
 * @author    Juan Ibarra juan.ibarra@openlms.net
 * @copyright Copyright (c) 2019 Open LMS (https://www.openlms.net)
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("theme_snap/messages",["jquery","core/pubsub"],(function($,PubSub){var openedpopovers=[];return{init:function(){if(0!==$(".preferences-page-container").length||0!==$(".message-app.main").length||0==$("#page-message-edit").length&&0==$("#page-message-index").length)0==$("#page-user-profile").length&&0==$(".userprofile #message-user-button").length&&0==$("#page-grade-report-user-index").length||($('#page-grade-report-user-index [id^="drawer-"].drawer[role="region"]').css("display","none"),PubSub.subscribe("message-drawer-create-conversation-with-user",(function(args){redirectToMessage(args)})),PubSub.subscribe("message-drawer-show-conversation",(function(args){redirectToMessage(args)})));else{var drawermessage=$(".drawer .message-app");drawermessage.css("visibility","visible"),drawermessage.animate({width:"100%"},0),document.addEventListener("messages-drawer:toggle",(function(){($("#page-message-edit").length||$("#page-message-index").length)&&($(".block_settings").hasClass("state-visible")?$(window).width()<560?$(".drawer .message-app").hide():$(".drawer .message-app").animate({width:"50%"},0):$(window).width()<560?$(".drawer .message-app").show():$(".drawer .message-app").animate({width:"100%"},0))})),document.addEventListener("messages-drawer:pm-toggle",(function(){($("#page-message-edit").length||$("#page-message-index").length)&&($(".snap-pm-open").length?$(".drawer .message-app").hide():$(".drawer .message-app").show())}));var popover=$("div.popover-region");popover.on("popoverregion:menuopened",(function(){if($("#page-message-edit").length||$("#page-message-index").length){var popovername=$(this).attr("id");-1==openedpopovers.indexOf(popovername)&&openedpopovers.push(popovername),openedpopovers.length>0&&($(window).width()<560?$(".drawer .message-app").hide():$(".drawer .message-app").animate({width:"50%"},0))}})).bind(),popover.on("popoverregion:menuclosed",(function(){if($("#page-message-edit").length||$("#page-message-index").length){var popovername=$(this).attr("id"),index=openedpopovers.indexOf(popovername);openedpopovers.splice(index,1),0==openedpopovers.length&&($(window).width()<560?$(".drawer .message-app").show():$(".drawer .message-app").animate({width:"100%"},0))}})).bind()}var redirectToMessage=function(args){let processedId="";processedId="object"==typeof args&&args.userid?parseInt(args.userid):parseInt(args);const moodleurl=M.cfg.wwwroot;window.location=moodleurl.concat("/message/index.php?id=",processedId)}}}}));

//# sourceMappingURL=messages.min.js.map